\documentclass{ximera}

\input{../preamble.tex}

\title{Lines, angles, and areas in central projection}

\begin{document}
\begin{abstract}
  Here we look at lines, angles, and areas in central projection coordinates. 
\end{abstract}
\maketitle

\section{Central projection preserves lines}

We all probably realize that you can't make a perfect map of the
world. You can't make a map so that angles on the map are equal to the
corresponding angles on the sphere and straight lines on the map
correspond to great circular arcs on the sphere. We do the next best
thing---we make two maps of the sphere, one that has the property that
angles are faithfully represented and the other for which straight
lines on the map correspond to shortest paths on the sphere. We start
with a simple way to make a map for which straight lines on the map
correspond to shortest paths on the sphere.  The map coordinates we
use to do this are the \textit{central projection coordinates}.






\begin{problem}
Show that ``lines'' in $K$-geometry correspond under central
projection to lines in $(x_{c},y_{c})$-coordinates.

\begin{hint}
  To intersect two surfaces, say $f(x,y,z)=a$ and $(g(x,y,z)=b$,
  simply examine
  \[
  f(x,y,z)-g(x,y,z) = a-b.
  \]
\end{hint}

\begin{hint}
  Explain why intersecting the $K$-surface
  \[
  1 = K\left(x^2+y^2\right) + z^2 
  \]
  with the plane
  \[
  ax+by+z = 0
  \]
  to produces a $K$ geometry line.
\end{hint}

\begin{hint}
  Use the projection formulas
  \begin{align*}
      x &= \frac{x_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}},\\
      y &= \frac{y_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}},\\
      z &= \frac{1}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}.\\
  \end{align*}
\end{hint}

\begin{freeResponse}
  Let's start by intersecting the surfaces
  \[
  K\left(x^2+y^2\right)+z^2=1\qquad\text{and}\qquad ax+by+z=0,
  \]
  where the latter is a plane passing through the origin. Write
  \[
  K\left(x^2+y^2\right) + z^2- ax- by-z=1.
  \]
  Now use the projection formulas to write
  \begin{align*}
    &K\left(\left( \frac{x_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}\right)^2
    +\left(\frac{y_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}\right)^2\right)
    + \left(\frac{1}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}\right)^2\\
    &-\frac{ax_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}- \frac{by_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}-\frac{1}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}=1.
  \end{align*}
Squaring and adding fractions, we find
\[
\frac{K\left(x_c^2 + y_c^2\right)+1}{K\left(x_c^2 + y_c^2\right)+1}-\frac{ax_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}- \frac{by_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}-\frac{1}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}=1.
\]
Hence
\begin{align*}
1-\frac{ax_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}- \frac{by_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}-\frac{1}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}} &=1\\
-\frac{ax_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}- \frac{by_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}-\frac{1}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}} &=0.
\end{align*}
Since $\sqrt{K\left(x_c^2 + y_c^2\right)+1} \ne 0$, we may clear
  denominators to find the following equation for a line
  \[
  ax_c+by_c+1= 0.
  \]
\end{freeResponse}
\end{problem}

\begin{problem}
  Explain why the answer from the previous question makes perfect sense if $K=0$.
  \begin{freeResponse}
    If $K=0$, our surface is the plane $z=1$, as we only consider the
    top sheet. In this case, we are intersecting the plane $z=1$ with
    the plane $ax+by+z=0$. This clearly gives the plane $ax_c+ by_c +
    1 = 0.$
  \end{freeResponse}
\end{problem}



\section{Length and angle in central projection coordinates}

\begin{problem}
\label{33}For the $K$-geometry coordinates%
\[
X=\left(  x,y,z\right)
\]
use the formulas you derived in a previous problem to calculate%
\[
dX=\left(  \frac{\partial X}{\partial x_{c}}\right)  dx_{c}+\left(
\frac{\partial X}{\partial y_{c}}\right)  dy_{c}%
\]
That is, calculate the $2\times3$ matrix%
\[
D_{c}=\begin{bmatrix}
\frac{\partial x}{\partial x_{c}} & \frac{\partial y}{\partial x_{c}} &
\frac{\partial z}{\partial x_{c}}\\
\frac{\partial x}{\partial y_{c}} & \frac{\partial y}{\partial y_{c}} &
\frac{\partial z}{\partial y_{c}}%
\end{bmatrix} =\begin{bmatrix}
\left(  \frac{\partial X}{\partial x_{c}}\right) \\
\left(  \frac{\partial X}{\partial y_{c}}\right)
\end{bmatrix} .
\]
\begin{hint}
Use logarithmic differentiation:%
\begin{align*}
dx  &  =d\left(  rx_{c}\right)  =x_{c}dr+rdx_{c}\\
r^{-1}dx  &  =x_{c}d\ln\left(  r\right)  +dx_{c}%
\end{align*}
and similarly for $y$ and $z$ since it is easier to compute $r^{-1}\left(
\frac{dx}{dt},\frac{dy}{dt},\frac{dz}{dt}\right)  $ than $\left(  \frac
{dx}{dt},\frac{dy}{dt},\frac{dz}{dt}\right)  $. Next use that%
\begin{align*}
2d\ln\left(  r\right)   &  =d\ln\left(  r^{2}\right)
=-d\ln\left(  K\left(  x_{c}^{2}+y_{c}^{2}\right)  +1\right) \\
&  =-\frac{1}{K\left(  x_{c}^{2}+y_{c}^{2}\right)  +1}d\left(  K\left(
x_{c}^{2}+y_{c}^{2}\right)  +1\right) \\
&  =-r^{2}K\left(  2x_{c}dx_{c}+2y_{c}dy_{c}\right)  .
\end{align*}
\end{hint}
\end{problem}

\begin{problem}
\label{prev}Now suppose we have a path,%
\[
\left(  x_{c}\left(  t\right)  ,y_{c}\left(  t\right)  \right)  ,\;a\leq t\leq
b
\]
in the $\left(  x_{c},y_{c}\right)  $-plane, that is, in the central
projection plane%
\[
\left(  x_{c},y_{c},1\right)  .
\]
Use the formula you derived in a previous problem to write the
corresponding path%
\[
x\left(  x_{c}\left(  t\right)  ,y_{c}\left(  t\right)  \right)  ,y\left(
x_{c}\left(  t\right)  ,y_{c}\left(  t\right)  \right)  ,z\left(  x_{c}\left(
t\right)  ,y_{c}\left(  t\right)  \right)
\]
in the $K$-geometry space of $\left(  x,y,z\right)  $ such that $K\left(
x^{2}+y^{2}\right)  +z^{2}=1$.
\end{problem}

\begin{problem}
For the path $\left( x\left( t\right) ,y\left( t\right) ,z\left(
t\right) \right) $ in a previous problem lying on the set
$1=K\left(x^{2}+y^{2}\right)+z^{2} $, use the Chain Rule from calculus
of several variables to compute%
\[
\left(  \frac{dx}{dt},\frac{dy}{dt},\frac{dz}{dt}\right)  =\left(
\frac{dx_{c}\left(  t\right)  }{dt},\frac{dy_{c}\left(  t\right)  }%
{dt}\right)  \cdot D_{c}.
\]

\end{problem}

This last Problem allows us to do something very nice. Namely now, not only
can we use the coordinates $\left(  x_{c},y_{c}\right)  $ for our geometry but
we can also compute the $K$-dot product in terms of these coordinates. By the
Chain Rule from calculus of several variables%
\[
\left(  \frac{dx}{dt},\frac{dy}{dt},\frac{dz}{dt}\right)  =\left(
\frac{dx_{c}}{dt},\frac{dy_{c}}{dt}\right)  \cdot D_{c}.
\]
So%
\begin{align*}
\left(  \frac{dx}{dt},\frac{dy}{dt},\frac{dz}{dt}\right)  \bullet_{K}\left(
\frac{dx}{dt},\frac{dy}{dt},\frac{dz}{dt}\right)   &  =\begin{bmatrix}
\frac{dx}{dt} & \frac{dy}{dt} & \frac{dz}{dt}%
\end{bmatrix} \begin{bmatrix}
1 & 0 & 0\\
0 & 1 & 0\\
0 & 0 & K^{-1}%
\end{bmatrix} \begin{bmatrix}
\frac{dx}{dt}\\
\frac{dy}{dt}\\
\frac{dz}{dt}%
\end{bmatrix}\\
&  =
\begin{bmatrix}
\frac{dx_{c}}{dt} & \frac{dy_{c}}{dt}%
\end{bmatrix} \cdot D_{c}\cdot\begin{bmatrix}
1 & 0 & 0\\
0 & 1 & 0\\
0 & 0 & K^{-1}%
\end{bmatrix} \cdot D_{c}^\transpose\cdot
\begin{bmatrix}
\frac{dx_{c}}{dt}\\
\frac{dy_{c}}{dt}%
\end{bmatrix},
\end{align*}


\begin{problem}
\label{32}Compute the $2\times2$ matrix%
\[
P_{c}=D_{c}\cdot\begin{bmatrix}
1 & 0 & 0\\
0 & 1 & 0\\
0 & 0 & K^{-1}%
\end{bmatrix} \cdot D_{c}^\transpose,
\]
that that gives the $K$-dot product in $\left(  x_{c},y_{c}\right)
$-coordinates. That is, use matrix multiplication to show that%
\[
P_{c}=
\begin{bmatrix}
r^{2}\left(  1-r^{2}Kx_{c}^{2}\right)  & -r^{4}Kx_{c}y_{c}\\
-r^{4}Kx_{c}y_{c} & r^{2}\left(  1-r^{2}Ky_{c}^{2}\right)
\end{bmatrix} .
\]


\begin{hint}For example%
\begin{align*}
\frac{\partial x}{\partial x_{c}}  &  =r\left(  x_{c}\frac{\partial \ln\left(
r\right)  }{\partial x_{c}}+1\right)  =-r^{3}Kx_{c}^{2}+r\\
\frac{\partial y}{\partial x_{c}}  &  =r\left(  y_{c}\frac{\partial \ln\left(
r\right)  }{\partial x_{c}}\right)  =-r^{3}Kx_{c}y_{c}\\
\frac{\partial z}{\partial x_{c}}  &  =r\left(  \frac{\partial \ln\left(
r\right)  }{\partial x_{c}}\right)  =-r^{3}Kx_{c}%
\end{align*}
so that%
\begin{align*}
&  \left(  \frac{\partial x}{\partial x_{c}},\frac{\partial y}{\partial x_{c}%
},\frac{\partial z}{\partial x_{c}}\right)  \bullet_{K}\left(  \frac{\partial
x}{\partial x_{c}},\frac{\partial y}{\partial x_{c}},\frac{\partial
z}{\partial x_{c}}\right) \\
&  =r^{6}K^{2}x_{c}^{4}-2r^{4}Kx_{c}^{2}+r^{2}+r^{6}K^{2}x_{c}^{2}y_{c}%
^{2}+r^{6}Kx_{c}^{2}\\
&  =\left(  r^{6}K^{2}x_{c}^{4}+r^{6}K^{2}x_{c}^{2}y_{c}^{2}+r^{6}Kx_{c}%
^{2}\right)  -2r^{4}Kx_{c}^{2}+r^{2}\\
&  =r^{4}Kx_{c}^{2}-2r^{4}Kx_{c}^{2}+r^{2}=r^{2}\left(  1-r^{2}Kx_{c}%
^{2}\right)  .
\end{align*}
\end{hint}
\end{problem}

If $K>0$ and you have a path on the sphere of radius $R=K^{-1/2}$ in
euclidean $3$-space given in $\left( x_{c},y_{c}\right) $-coordinates
as $\left( x_{c}\left( t\right) ,y_{c}\left( t\right) \right) $ for
$t\in\left[ b,e\right] $, you can trace back everything we have done
with coordinate changes to see that the length of the path on the
sphere of radius $R=K^{-1/2}$ in euclidean $3$-space is given by%
\[
\int_{b}^{e}\l(t)\d t
\]
where%
\begin{align*}
\l(t)  ^{2}  &  =\left(  \frac{dx_{c}}{dt},\frac{dy_{c}}%
{dt}\right)  \bullet_{c}\left(  \frac{dx_{c}}{dt},\frac{dy_{c}}{dt}\right) \\
&  =
\begin{bmatrix}
\frac{dx_{c}}{dt} & \frac{dy_{c}}{dt}%
\end{bmatrix} \cdot P_{c}\cdot\begin{bmatrix}
\frac{dx_{c}}{dt}\\
\frac{dy_{c}}{dt}%
\end{bmatrix} .
\end{align*}
Notice that the matrix $P_{c}$ still makes sense when $K=0$ and when $K$
becomes negative. So we do have%
\[{\renewcommand{\arraystretch}{1.6}
\frame{%
\begin{tabular}
[c]{c|c|c}%
\textit{Spherical} ($K>0$) & \textit{Euclidean} ($K=0$) & \textit{Hyperbolic}
($K<0$)\\\hline
$\hat{x}^{2}+\hat{y}^{2}+\hat{z}^{2}=R^{2}$ &  & \\ \hline
$\hat{V}\bullet\hat{V}$ &  & \\ \hline
$1=K\left(  x^{2}+y^{2}\right)  +z^{2}$ & $1=K\left(  x^{2}+y^{2}\right)
+z^{2}$ & $1=K\left(  x^{2}+y^{2}\right)  +z^{2}$\\ \hline
$V_{1}\bullet_{K}V_{2}$ &  & $V_{1}\bullet_{K}V_{2}$\\ \hline
$V_{1}^{c}\bullet_{c}V_{2}^{c}$ & $V_{1}^{c}\bullet_{c}V_{2}^{c}$ & $V_{1}%
^{c}\bullet_{c}V_{2}^{c}$%
\end{tabular}
}}
\]
where%
\[
V_{1}^{c}\bullet_{c}V_{2}^{c}=\left(  V_{1}^{c}\right)  \cdot P_{c}%
\cdot\left(  V_{2}^{c}\right)  ^\transpose.
\]
Of course if $K>0$, we again have euclidean angles $\theta$ between vectors
$\hat{V}_{1}$ and $\hat{V}_{2}$ tangent to the $R$-sphere at some point
computed by%
\begin{align*}
\hat{V}_{1}\bullet\hat{V}_{2}  &  =\left\vert \hat{V}_{1}\right\vert
\cdot\left\vert \hat{V}_{2}\right\vert
\text{\textperiodcentered\textrm{cos}}\left(  \theta\right) \\
&  =V_{1}^{c}\bullet_{c}V_{2}^{c}.
\end{align*}


\section{Area in central projection coordinates}

Suppose you were given a region $G_{c}$ in the $\left(  x_{c},y_{c}\right)
$-coordinate plane. Also suppose that $K>0$. If you trace back everything we
have done with coordinate changes, you can see how $G_{c}$ gives you a region
$\hat{G}$ on the sphere of radius $R=K^{-1/2}$ in euclidean $3$-space via the
formulas%
\begin{align*}
\left(  \hat{x},\hat{y},\hat{z}\right)   &  =\left(  x,y,Rz\right) \\
&  =r\cdot\left(  x_{c},y_{c},R\right) \\
&  =\left(  \frac{x_{c}}{\sqrt{K\left(  x_{c}^{2}+y_{c}^{2}\right)  +1}}%
,\frac{y_{c}}{\sqrt{K\left(  x_{c}^{2}+y_{c}^{2}\right)  +1}},\frac{R}%
{\sqrt{K\left(  x_{c}^{2}+y_{c}^{2}\right)  +1}}\right)  .
\end{align*}
Now there is a formula in several variable calculus for computing the area of
the region $\hat{G}$ on the sphere of radius $R$ in euclidean $3$-space in
terms of the parameters $\left(  x_{c},y_{c}\right)  $. [DS,49,231]. It is
\begin{equation}%
\int_{G_{c}}
\hat{a}\left(  \frac{d\hat{X}}{dx_{c}},\frac{d\hat{X}}{dy_{c}}\right)
dx_{c}dy_{c} \label{68}%
\end{equation}
where $\hat{a}\left(  \frac{d\hat{X}}{dx_{c}},\frac{d\hat{X}}{dy_{c}}\right)
$ is the (euclidean) area of the parallelogram spanned by the two vectors
$\frac{d\hat{X}}{dx_{c}}$ and $\frac{d\hat{X}}{dy_{c}}$ in euclidean
$3$-space. Thus%
\[
\hat{a}\left(  \frac{d\hat{X}}{dx_{c}},\frac{d\hat{X}}{dy_{c}}\right)
=\left\vert \frac{d\hat{X}}{dx_{c}}\right\vert \text{\textperiodcentered
}\left\vert \frac{d\hat{X}}{dy_{c}}\right\vert \text{\textperiodcentered
}\mathrm{sin}\left(  \theta\right)
\]
where $\theta$ is the angle between the two vectors.

\begin{problem}
Using previous problems show that%
\begin{align*}
\hat{a}\left(  \frac{d\hat{X}}{dx_{c}},\frac{d\hat{X}}{dy_{c}}\right)  ^{2}
&  =\det
\begin{bmatrix}
\frac{d\hat{X}}{dx_{c}}\bullet\frac{d\hat{X}}{dx_{c}} & \frac{d\hat{X}}%
{dy_{c}}\bullet\frac{d\hat{X}}{dx_{c}}\\
\frac{d\hat{X}}{dx_{c}}\bullet\frac{d\hat{X}}{dy_{c}} & \frac{d\hat{X}}%
{dy_{c}}\bullet\frac{d\hat{X}}{dy_{c}}%
\end{bmatrix} \\
&  =\det
\begin{bmatrix}
\frac{dX}{dx_{c}}\bullet_{K}\frac{dX}{dx_{c}} & \frac{dX}{dy_{c}}\bullet
_{K}\frac{dX}{dx_{c}}\\
\frac{dX}{dx_{c}}\bullet_{K}\frac{dX}{dy_{c}} & \frac{dX}{dy_{c}}\bullet
_{K}\frac{dX}{dy_{c}}%
\end{bmatrix} \\
&=\det\left(\begin{bmatrix}
\frac{dX}{dx_{c}} \\
\frac{dX}{dy_{c}}
\end{bmatrix} 
\begin{bmatrix}
1 & 0 & 0\\
0 & 1 & 0\\
0 & 0 & K^{-1}%
\end{bmatrix}\begin{bmatrix}
\left(  \frac{dX}{dx_{c}}\right)  ^\transpose & \left(  \frac{dX}{dy_{c}}\right)
^\transpose%
\end{bmatrix}\right) \\
&  =\left\vert P_{c}\right\vert .
\end{align*}

\end{problem}

\begin{problem}
\label{79}Use a previous problem to show that%
\[
\hat{a}\left(  \frac{d\hat{X}}{dx_{c}},\frac{d\hat{X}}{dy_{c}}\right)
^{2}=r^{6}=\frac{1}{\left(  K\left(  x_{c}^{2}+y_{c}^{2}\right)  +1\right)
^{3}}%
\]
as a function of $\left(  x_{c},y_{c}\right)  $.

\begin{hint}
Notice that the matrix $D_{c}$ is simply the $2\times3$ matrix whose
rows are the vectors $\frac{dX}{dx_{c}}$ and $\frac {dX}{dy_{c}}$. So, we know that%
\[
\begin{bmatrix}
\frac{d\hat{X}}{dx_{c}}\bullet\frac{d\hat{X}}{dx_{c}} & \frac{d\hat{X}}%
{dy_{c}}\bullet\frac{d\hat{X}}{dx_{c}}\\
\frac{d\hat{X}}{dx_{c}}\bullet\frac{d\hat{X}}{dy_{c}} & \frac{d\hat{X}}%
{dy_{c}}\bullet\frac{d\hat{X}}{dy_{c}}%
\end{bmatrix} =
\begin{bmatrix}
r^{2}\left(  1-r^{2}Kx_{c}^{2}\right)  & -r^{4}Kx_{c}y_{c}\\
-r^{4}Kx_{c}y_{c} & r^{2}\left(  1-r^{2}Ky_{c}^{2}\right)
\end{bmatrix} .
\]
\end{hint}
\end{problem}

Since all these computations can be extended to $K$-geometry for all
$K$, we define the $K$-area of a region $G_{c}$ in the $\left(
x_{c},y_{c}\right) $-coordinate plane by first computing the $K$-area
of the parallelogram spanned by $\frac{dX}{dx_{c}}$ and
$\frac{dX}{dy_{c}}$ at each point of $G_{c}$ as%
\begin{align*}
a_{K}\left(  \frac{dX}{dx_{c}},\frac{dY}{dy_{c}}\right) &=\left\vert
\frac{dX}{dx_{c}}\right\vert _{K}\cdot\left\vert \frac{dX}{dy_{c}}\right\vert
_{K}\cdot\mathrm{sin}\left(  \theta_{K}\right) \\
&  =\sqrt{\det
\begin{bmatrix}
\frac{dX}{dx_{c}}\bullet_{K}\frac{dX}{dx_{c}} & \frac{dX}{dy_{c}}\bullet
_{K}\frac{dX}{dx_{c}}\\
\frac{dX}{dx_{c}}\bullet_{K}\frac{dX}{dy_{c}} & \frac{dX}{dy_{c}}\bullet
_{K}\frac{dX}{dy_{c}}%
\end{bmatrix}}%
\end{align*}
and then integrating this area over $G_{c}$ to get%
\begin{align*}
A_{K}\left(  G_{c}\right) &=
\int_{G_{c}}
a_{K}\left(  \frac{dX}{dx_{c}},\frac{dY}{dy_{c}}\right)  dx_{c}dy_{c}\\
&  =%
\int_{G_{c}}
\sqrt{\det
\begin{bmatrix}
\frac{dX}{dx_{c}}\bullet_{K}\frac{dX}{dx_{c}} & \frac{dX}{dy_{c}}\bullet
_{K}\frac{dX}{dx_{c}}\\
\frac{dX}{dx_{c}}\bullet_{K}\frac{dX}{dy_{c}} & \frac{dX}{dy_{c}}\bullet
_{K}\frac{dX}{dy_{c}}%
\end{bmatrix}}\d x_{c}dy_{c}.
\end{align*}





\end{document}
