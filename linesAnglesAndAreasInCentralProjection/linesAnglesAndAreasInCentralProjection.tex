\documentclass{ximera}

\input{../preamble.tex}

\title{Lines, angles, and areas in central projection}

\begin{document}
\begin{abstract}
  Here we look at lines, angles, and areas in central projection coordinates. 
\end{abstract}
\maketitle

\section{Central projection preserves lines}

We all probably realize that you can't make a perfect map of the
world. You can't make a map so that angles on the map are equal to the
corresponding angles on the sphere and straight lines on the map
correspond to great circular arcs on the sphere. We do the next best
thing---we make two maps of the sphere, one that has the property that
angles are faithfully represented and the other for which straight
lines on the map correspond to shortest paths on the sphere. We start
with a simple way to make a map for which straight lines on the map
correspond to shortest paths on the sphere.  The map coordinates we
use to do this are the \textit{central projection coordinates}.






\begin{problem}
Show that ``lines'' in $K$-geometry correspond under central
projection to lines in $(x_{c},y_{c})$-coordinates.

\begin{hint}
  To intersect two surfaces, say $f(x,y,z)=a$ and $(g(x,y,z)=b$,
  simply examine
  \[
  f(x,y,z)-g(x,y,z) = a-b.
  \]
\end{hint}

\begin{hint}
  Explain why intersecting the $K$-surface
  \[
  1 = K\left(x^2+y^2\right) + z^2 
  \]
  with the plane
  \[
  ax+by+z = 0
  \]
  to produces a $K$ geometry line.
\end{hint}

\begin{hint}
  Use the projection formulas
  \begin{align*}
      x &= \frac{x_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}},\\
      y &= \frac{y_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}},\\
      z &= \frac{1}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}.\\
  \end{align*}
\end{hint}

\begin{freeResponse}
  Let's start by intersecting the surfaces
  \[
  K\left(x^2+y^2\right)+z^2=1\qquad\text{and}\qquad ax+by+z=0,
  \]
  where the latter is a plane passing through the origin. Write
  \[
  K\left(x^2+y^2\right) + z^2- ax- by-z=1.
  \]
  Now use the projection formulas to write
  \begin{align*}
    &K\left(\left( \frac{x_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}\right)^2
    +\left(\frac{y_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}\right)^2\right)
    + \left(\frac{1}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}\right)^2\\
    &-\frac{ax_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}- \frac{by_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}-\frac{1}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}=1.
  \end{align*}
Squaring and adding fractions, we find
\[
\frac{K\left(x_c^2 + y_c^2\right)+1}{K\left(x_c^2 + y_c^2\right)+1}-\frac{ax_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}- \frac{by_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}-\frac{1}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}=1.
\]
Hence
\begin{align*}
1-\frac{ax_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}- \frac{by_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}-\frac{1}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}} &=1\\
-\frac{ax_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}- \frac{by_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}-\frac{1}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}} &=0.
\end{align*}
Since $\sqrt{K\left(x_c^2 + y_c^2\right)+1} \ne 0$, we may clear
  denominators to find the following equation for a line
  \[
  ax_c+by_c+1= 0.
  \]
\end{freeResponse}
\end{problem}

\begin{problem}
  Explain why the answer from the previous question makes perfect sense if $K=0$.
  \begin{freeResponse}
    If $K=0$, our surface is the plane $z=1$, as we only consider the
    top sheet. In this case, we are intersecting the plane $z=1$ with
    the plane $ax+by+z=0$. This clearly gives the plane $ax_c+ by_c +
    1 = 0.$
  \end{freeResponse}
\end{problem}



\section{Angles in central projection coordinates}

While central projection coordinates ``preserve'' lines, meaning that
shortest paths in euclidean geometry, spherical geometry, and
hyperboloic geometry are all mapped to lines, it does not preserve
angles. To see this, we simply need to give an example.


Consider the simplest case: Lines in $K$-geometry defined by
intersecting
\[
K\left(x^2+y^2\right) + z^2 = 1
\]
with the planes
\[
x=0 \qquad\text{and}\qquad y=0.
\]

\begin{problem}
  Reason geometrically why these ``lines'' in $K$-geometry correspond
  to the the $x_c$-axis and the $y_c$-axis in central projection
  coordinates.
\end{problem}

We know from previous work that when $K>0$, the lines described above
can be parameterized by
\[
(0, R\cdot \sin\varepsilon,\cos\varepsilon)\qquad\text{and}\qquad(R\cdot \sin\varepsilon, 0, \cos\varepsilon)
\]
and a similar result (left to you, bold reader) holds for when
$K<0$. Note, these curves intersect at the North Pole when
$\varepsilon =0$.

\begin{problem}
  Use the $K$-dot product to compute the angle between these ``lines'' when $\varepsilon=0$.
  \begin{hint}
    You should be looking at the angle between the tangent vectors.
  \end{hint}
\end{problem}

\begin{problem}
  Convert the curves
  \[
  (0, R\cdot\sin\varepsilon,\cos\varepsilon)\qquad\text{and}\qquad(R\cdot \sin\varepsilon, 0, \cos\varepsilon)
  \]
  to curves in central projection.
  \begin{freeResponse}
    We must compute
    \begin{align*}
      x_{c} &=x/z,\\
      y_{c} &=y/z.
    \end{align*}
    for both
      \[
  (0, R\cdot\sin\varepsilon,\cos\varepsilon)\qquad\text{and}\qquad(R\cdot
      \sin\varepsilon, 0 \cos\varepsilon).
      \]
      Hence we obtain the curves
      \[
      (0,R\cdot\tan\varepsilon)\qquad\text{and}\qquad(R\cdot\tan\varepsilon,0)
      \]
      which correspond to the $y_c$-axis and $x_c$-axis.
  \end{freeResponse}
\end{problem}

\begin{problem}
  Imagine that the two curves
  \[
  (0,R\cdot\tan\varepsilon)\qquad\text{and}\qquad(R\cdot\tan\varepsilon,0)
  \]
  are in the euclidean plane and compute the angle between them at
  $\varepsilon=0$.  How does this compare with the \textit{actual}
  $K$-dot product angle?
  \begin{hint}
    Remember you should be looking at the tangent vectors.
  \end{hint}
\end{problem}

\begin{problem}
  Now apply the rigid motion
  \[
  N_\psi=
 \begin{bmatrix}
   \cos\psi & 0 & R^{-1}\cdot\sin\psi\\
   0 & 1 & 0\\
   -R\cdot\sin\psi & 0 & \cos\psi
 \end{bmatrix}
 \]
 to our curves
 \[
 (0, R\cdot\sin\varepsilon,\cos\varepsilon)\qquad\text{and}\qquad(R\cdot
 \sin\varepsilon, 0, \cos\varepsilon),
 \]
 and then compute the central projection of these curves.
\end{problem}

\begin{problem}
  Imagine that the two curves found above are in the euclidean plane
  and compute the angle between them at $\varepsilon = 0$.  How does
  this compare with the \textit{actual} $K$-dot product angle?
  \begin{hint}
    Remember you should be looking at the tangent vectors.
  \end{hint}
\end{problem}

\begin{problem}
  Explain what is meant when someone says that ``central projection
  does not preserve angles.''
\end{problem}


\section{Areas in central projection coordinates}

\subsection{The area of half a lune}

We have already seen that on the $R$-sphere, the area of an
$\alpha$-lune is $2\alpha\cdot R^2$. Let's compute this a different
way.

\begin{problem}
  Let $K>0$ and consider the following region in central projection
 \begin{image}
   \includegraphics[width=3in]{halfLune.png}
 \end{image}
 Use the fact that the area of an $\alpha$-lune is $2\alpha\cdot R^2$
 to compute the area of the region.
\end{problem}

On the other hand, we know that the area in spherical geometry
represented by the region in central projection is given by
\[
\int_{L_c} \sqrt{
  \det
  \begin{bmatrix}
    \dd[X]{x_c}\bullet_K \dd[X]{x_c} & \dd[X]{y_c}\bullet_K \dd[X]{x_c} \\
    \dd[X]{x_c}\bullet_K \dd[X]{y_c} & \dd[X]{y_c}\bullet_K \dd[X]{y_c}
  \end{bmatrix}
}\d x_c\d y_c
\]

\begin{problem}
  Give a heuristic explanation of why this integral computes what we
  say it computes.
\end{problem}

You have already shown that
\[
\int_{L_c} \sqrt{
  \det
  \begin{bmatrix}
    \dd[X]{x_c}\bullet_K \dd[X]{x_c} & \dd[X]{y_c}\bullet_K \dd[X]{x_c} \\
    \dd[X]{x_c}\bullet_K \dd[X]{y_c} & \dd[X]{y_c}\bullet_K \dd[X]{y_c}
  \end{bmatrix}
}\d x_c\d y_c
\]
\[
=
\int_{L_c} \sqrt{
  \det\left(
  \begin{bmatrix}
    \dd[X]{x_c}\\
    \dd[X]{y_c}
  \end{bmatrix}
  \begin{bmatrix}
    1 & 0 & 0\\
    0 & 1 & 0\\
    0 & 0 & K^{-1}
  \end{bmatrix}
  \begin{bmatrix}
    \left(\dd[X]{x_c}\right)^\transpose & \left(\dd[X]{y_c}\right)^\transpose
  \end{bmatrix}\right)
}\d x_c\d y_c
\]

\begin{problem}
  Explain why
  \[
\begin{bmatrix}
    \dd[X]{x_c}\\
    \dd[X]{y_c}
  \end{bmatrix}
  \begin{bmatrix}
    1 & 0 & 0\\
    0 & 1 & 0\\
    0 & 0 & K^{-1}
  \end{bmatrix}
  \begin{bmatrix}
    \left(\dd[X]{x_c}\right)^\transpose & \left(\dd[X]{y_c}\right)^\transpose
  \end{bmatrix} =P_c.
  \]
  \begin{hint}
    No new computations need to be done, just look at how $P_c$ was derived.
  \end{hint}
\end{problem}

Hence now we see 
\[
\int_{L_c} \sqrt{
  \det
  \begin{bmatrix}
    \dd[X]{x_c}\bullet_K \dd[X]{x_c} & \dd[X]{y_c}\bullet_K \dd[X]{x_c} \\
    \dd[X]{x_c}\bullet_K \dd[X]{y_c} & \dd[X]{y_c}\bullet_K \dd[X]{y_c}
  \end{bmatrix}
}\d x_c\d y_c = \int_{L_c} \sqrt{\det P_c}\d x_c\d y_c
\]
\begin{problem}
  Compute $\sqrt{\det P_c}$.
  \begin{hint}
    As a gesture of friendship, we'll remind you that
    \[
 P_c =
     \begin{bmatrix}
       \left(Ky_c^2+1\right)\lambda^4 & -Kx_{c}y_{c}\lambda^4\\
       -Kx_{c}y_{c}\lambda^4 & \left(Kx_c^2+1\right)\lambda^4
     \end{bmatrix} = \lambda^4 \cdot \begin{bmatrix}
       Ky_c^2+1 & -Kx_{c}y_{c}\\
       -Kx_{c}y_{c} & \left(Kx_c^2+1\right)
     \end{bmatrix}.
    \]
  \end{hint}
  \begin{freeResponse}
    Write
    \begin{align*}
    \det P_c &= \lambda^4\cdot \det \begin{bmatrix}
       Ky_c^2+1 & -Kx_{c}y_{c}\\
       -Kx_{c}y_{c} & \left(Kx_c^2+1\right)
    \end{bmatrix}\\
    &= \lambda^4\cdot\left(\left( Ky_c^2+1\right)\left(Kx_c^2+1\right) - K^2x_{c}^2y_{c}^2\right)\\
    &= \lambda^4\cdot\left(K^2x_{c}^2y_{c}^2 + Ky_c^2+Kx_c^2+1-K^2x_{c}^2y_{c}^2\right)\\
    &= \lambda^4\cdot\left(Ky_c^2+Kx_c^2+1\right)
    \end{align*}
    However, $\lambda = \frac{1}{K\left(x_c^2+y_c^2\right)+1}$, so
    \[
    \sqrt{\det P_c} = \frac{1}{\left(K\left(x_c^2+y_c^2\right)+1\right)^{3/2}}.
    \]
  \end{freeResponse}
\end{problem}

At this point we see we are interested in the following integral
\[
\int_{L_c} \frac{1}{\left(K\left(x_c^2+y_c^2\right)+1\right)^{3/2}} \d x_c\d y_c.
\]

\begin{problem}
  Examining the following diagram
  \begin{image}
    \includegraphics[width=3in]{halfLune.png}
  \end{image}
  convert
  \[
  \int_{L_c} \frac{1}{\left(K\left(x_c^2+y_c^2\right)+1\right)^{3/2}} \d x_c\d y_c.
  \]
  to polar coordinates and compute the integral.
  \begin{hint}
    Recall that to covert to polar coordinates, set
    \begin{align*}
      r &= \sqrt{x_c^2+y_c^2},\\
      \theta &= \arctan(y/x),
    \end{align*}
    and replace $\d x_c\d y_c$ with $r\d r\d \theta$.
  \end{hint}
  \begin{freeResponse}
    \[
    \int_{L_c}
    \frac{1}{\left(K\left(x_c^2+y_c^2\right)+1\right)^{3/2}} \d x_c\d
    y_c = \int_0^\alpha \int_0^\infty \frac{1}{K\left(r^2+1\right)^{3/2}} r\d r \d \theta.
    \]
    Integrating this from the inside-out we find
    \begin{align*}
      \int_0^\alpha \int_0^\infty \frac{1}{K\left(r^2+1\right)^{3/2}} r\d r \d \theta &= \int_0^\alpha \eval{\frac{-1}{K\left(r^2+1\right)^{1/2}}}_0^\infty \d \theta\\
      &= \int_0^\alpha \frac{1}{K} \d \theta\\
      &= \frac{\alpha}{K}.   
    \end{align*}
    Recalling that $K = \frac{1}{R^2}$ we find our final answer is $\alpha \cdot R^2$.
  \end{freeResponse}
\end{problem}

\begin{problem}
  Reconcile this computation with what you know about the area of the
  $\alpha$-lune.
\end{problem}


\section{Central projection unifies euclidean, spherical, and hyperbolic geometry}

Under central projection, our new dot product defined by
\[
V_c\bullet_c W_c = V_c\cdot P_c\cdot W_c^\transpose
\]
make sense when $K$ is zero, positive, and negative. Hence this dot
product makes sense for euclidean, spherical, and hyperbolic
geometry. Moreover, in central projection, shortest paths on the $K$ surface
\[
K\left(x^2 + y^2\right) + z^2 = 1
\]
map to lines in the plane $z=1$. However, there is one trade-off:
Angles are not preserved in central projection. This means that when
angles are projected into the plane via central projection, the angle
we see in the $(x_c,y_c)$-plane may or may not be the actual angle
between two vectors. Summarizing, we have:



\[
{\renewcommand{\arraystretch}{2.7}
  \begin{tabular}{|c||c|c|c|}\hline
    & \begin{minipage}{2cm}\begin{center}Spherical ($K>0$)\end{center}\end{minipage} & \begin{minipage}{2cm}\begin{center}Euclidean ($K=0$)\end{center}\end{minipage} & \begin{minipage}{2cm}\begin{center}Hyperbolic ($K<0$)\end{center}\end{minipage}\\\hline\hline
    \begin{minipage}{2cm}\begin{center}Surface in \\ euclidean space\end{center}\end{minipage} & $\hat{x}^{2}+\hat{y}^{2}+\hat{z}^{2}=R^{2}$ & DNE  & DNE \\\hline
    \begin{minipage}{2cm}\begin{center}Euclidean dot product\end{center}\end{minipage} & $\hat{V}\cdot \hat{W}^\transpose$ & DNE  & DNE\\\hline
     \begin{minipage}{2cm}\begin{center}Surface in $K$-warped space\end{center}\end{minipage} & \multicolumn{3}{c|}{$1=K\left(  x^{2}+y^{2}\right)  +z^{2}$}\\\hline
     \begin{minipage}{2cm}\begin{center}$K$-dot product\end{center}\end{minipage} & $V\left[\begin{smallmatrix}1 & 0 & 0\\ 0 & 1 & 0\\ 0 & 0 & K^{-1}\end{smallmatrix}\right] W^\transpose$ &  DNE & $V\left[\begin{smallmatrix}1 & 0 & 0\\ 0 & 1 & 0\\ 0 & 0 & K^{-1}\end{smallmatrix}\right]W^\transpose$\\\hline
     \begin{minipage}{2cm}\begin{center}Central dot product\end{center}\end{minipage} & \multicolumn{3}{c|}{$V_c\cdot P_c\cdot W_c^\transpose = V_c\left[\begin{smallmatrix}\left(Ky_c^2+1\right)\lambda^4 & -Kx_{c}y_{c}\lambda^4\\
    -Kx_{c}y_{c}\lambda^4 & \left(Kx_c^2+1\right)\lambda^4\end{smallmatrix}\right] W_c^\transpose$}\\\hline
\end{tabular}}
\]




\begin{problem}
Summarize the results from this section. In particular, indicate which
results follow from the others.
\begin{freeResponse}
\end{freeResponse}
\end{problem}

\end{document}
